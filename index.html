<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DGS ROI Calculator Suite</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
:root {
  --green: #3fa36b;
  --green-hover: #318d5a;
  --dark: #1e1e1e;
  --gray: #dcdcdc;
  --light: #f9f9f9;
  --text: #333;
  --border: #e0e0e0;
}
[data-theme="dark"] {
  --light: #121212;
  --text: #f1f1f1;
  --gray: #2a2a2a;
  --dark: #000;
  --border: #333;
}
* { box-sizing: border-box; margin:0; padding:0; }
body { font-family: "Inter", sans-serif; background: var(--light); color: var(--text); transition: background 0.3s, color 0.3s; }
.topbar { position: fixed; top:0; left:0; right:0; height:70px; background: var(--dark); display:flex; align-items:center; justify-content:space-between; padding:0 40px; z-index:1000; border-bottom:3px solid var(--green); box-shadow:0 2px 10px rgba(0,0,0,0.1);}
.logo { color: var(--green); font-weight:700; font-size:1.5rem; letter-spacing:1px;}
.topbar-right { display:flex; align-items:center; gap:15px;}
.btn { background:var(--green); color:white; padding:10px 20px; border:none; border-radius:6px; cursor:pointer; font-size:0.9rem; font-weight:500; transition: background 0.2s;}
.btn:hover { background: var(--green-hover);}
.btn-secondary { background:#555;}
.btn-secondary:hover { background:#444;}
.container { max-width:1400px; margin:90px auto 40px; padding:0 40px;}
.page-header { margin-bottom:40px;}
.page-header h1 { color: var(--text); font-size:2.2rem; margin-bottom:10px; font-weight:700;}
.page-header p { color:#666; font-size:1.1rem;}
[data-theme="dark"] .page-header p { color:#999; }
.calculator-nav { display:flex; gap:10px; margin-bottom:30px; overflow-x:auto; padding-bottom:10px;}
.calculator-nav button { background:white; color:var(--text); border:2px solid var(--border); padding:12px 24px; border-radius:8px; cursor:pointer; font-size:0.95rem; font-weight:500; white-space:nowrap; transition:all 0.2s;}
[data-theme="dark"] .calculator-nav button { background:#2a2a2a; }
.calculator-nav button:hover { border-color: var(--green); color: var(--green);}
.calculator-nav button.active { background: var(--green); color:white; border-color: var(--green);}
.calculator-content { display:none; }
.calculator-content.active { display:grid; grid-template-columns:1fr 1fr; gap:30px;}
.input-panel, .output-panel { background:white; padding:30px; border-radius:12px; border:1px solid var(--border); box-shadow:0 2px 8px rgba(0,0,0,0.05);}
[data-theme="dark"] .input-panel, [data-theme="dark"] .output-panel { background:#1e1e1e;}
.panel-header { font-size:1.3rem; font-weight:600; margin-bottom:25px; color:var(--text); padding-bottom:15px; border-bottom:2px solid var(--border);}
.form-group { margin-bottom:20px;}
.form-group label { display:block; font-size:0.95rem; font-weight:500; margin-bottom:8px; color:var(--text);}
.form-group input { width:100%; padding:12px 15px; border:2px solid var(--border); border-radius:8px; background: var(--light); color:var(--text); font-size:1rem; transition:border-color 0.2s;}
.form-group input:focus { outline:none; border-color: var(--green);}
.btn-group { display:flex; gap:12px; margin-top:25px;}
.btn-group .btn { flex:1;}
.results { margin-top:20px;}
.result-item { display:flex; justify-content:space-between; align-items:center; padding:15px; margin-bottom:10px; background:#f5f5f5; border-radius:8px; border-left:4px solid var(--green);}
[data-theme="dark"] .result-item { background:#2a2a2a; }
.result-label { font-weight:500; font-size:0.95rem;}
.result-value { font-weight:700; font-size:1.1rem; color:var(--green);}
.chart-container { margin-top:30px; padding:20px; background:#f9f9f9; border-radius:8px; border:1px solid var(--border);}
[data-theme="dark"] .chart-container { background:#1a1a1a;}
canvas { max-height:300px;}
.scenarios-section { margin-top:40px; background:white; padding:30px; border-radius:12px; border:1px solid var(--border); box-shadow:0 2px 8px rgba(0,0,0,0.05);}
[data-theme="dark"] .scenarios-section { background:#1e1e1e;}
.scenario-item { background: var(--light); padding:20px; border-radius:8px; margin-top:15px; display:flex; justify-content:space-between; align-items:center; border:1px solid var(--border);}
.tooltip {position: relative; display:inline-block; cursor:pointer; margin-left:5px;}
.tooltip .tooltiptext {visibility:hidden; width:220px; background-color:var(--text); color:var(--light); text-align:left; border-radius:6px; padding:8px; position:absolute; z-index:1; bottom:125%; left:50%; transform:translateX(-50%); opacity:0; transition: opacity 0.3s; font-size:0.85rem;}
.tooltip:hover .tooltiptext {visibility:visible; opacity:1;}
footer { text-align:center; padding:20px; background:var(--dark); color:white; margin-top:60px; border-top:3px solid var(--green); font-size:0.9rem;}
footer a { color:var(--green); text-decoration:none; margin:0 10px;}
@media (max-width:1024px) { .calculator-content.active { grid-template-columns:1fr;} }
@media print { .topbar,.calculator-nav,.btn { display:none !important;} .container{margin-top:20px;} }
</style>
</head>
<body data-theme="light">

<div class="topbar">
  <div class="logo">DGS CONSULTING</div>
  <div class="topbar-right">
    <button class="btn btn-secondary" id="themeToggle" onclick="toggleTheme()">Dark Mode</button>
    <button class="btn" onclick="exportPDF()">Export PDF</button>
  </div>
</div>

<div class="container">
  <div class="page-header">
    <h1>ROI Calculator Dashboard</h1>
    <p>Professional financial analysis and return on investment calculations</p>
  </div>

  <div class="calculator-nav">
    <button class="active" onclick="showCalculator('process')">Process Improvement</button>
    <button onclick="showCalculator('software')">Software Investment</button>
    <button onclick="showCalculator('training')">Training Program</button>
    <button onclick="showCalculator('payback')">Payback Period</button>
    <button onclick="showCalculator('breakeven')">Break-Even Analysis</button>
    <button onclick="showCalculator('npv')">NPV & IRR</button>
  </div>

  <!-- Calculators Sections -->
  <div id="process" class="calculator-content"></div>
  <div id="software" class="calculator-content"></div>
  <div id="training" class="calculator-content"></div>
  <div id="payback" class="calculator-content"></div>
  <div id="breakeven" class="calculator-content"></div>
  <div id="npv" class="calculator-content"></div>

  <div class="scenarios-section">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
      <h2 class="panel-header" style="margin:0; border:none; padding:0;">Saved Scenarios</h2>
      <div style="display:flex; gap:10px;">
        <button class="btn" onclick="saveScenario()">Save Current Results</button>
        <button class="btn btn-secondary" onclick="exportCSV()">Export to CSV</button>
      </div>
    </div>
    <div id="scenario_list">
      <p style="color:#666; font-style:italic;">No saved scenarios yet. Run calculations and click Save Current Results.</p>
    </div>
  </div>
</div>

<footer>
  &copy; 2025 DGS Consulting - ROI Calculator Suite
  <a href="#">Privacy Policy</a>
  <a href="#">Terms of Service</a>
</footer>

<script>
// -- Existing calculator logic here (same as previous) --
// We'll just update the exportPDF function:

async function exportPDF(){
  const calcEl=document.getElementById(currentCalculator);
  const canvas = await html2canvas(calcEl, {scale:2});
  const imgData = canvas.toDataURL('image/png');
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF('p','mm','a4');
  const pageWidth = pdf.internal.pageSize.getWidth();
  const pageHeight = pdf.internal.pageSize.getHeight();
  const imgProps = pdf.getImageProperties(imgData);
  const pdfHeight = (imgProps.height * pageWidth) / imgProps.width;
  
  if(pdfHeight <= pageHeight){
    pdf.addImage(imgData,'PNG',0,0,pageWidth,pdfHeight);
  } else {
    let heightLeft = pdfHeight;
    let position = 0;
    while(heightLeft > 0){
      pdf.addImage(imgData,'PNG',0,position,pageWidth,pdfHeight);
      heightLeft -= pageHeight;
      position -= pageHeight;
      if(heightLeft > 0) pdf.addPage();
    }
  }
  pdf.save(`${currentCalculator}_calculator.pdf`);
}
</script>

</body>
</html>
