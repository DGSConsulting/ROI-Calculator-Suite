<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ROI Calculator — DGS Consulting</title>
<style>
:root{
  --primary:#3cb371;
  --primary-dark:#2f9d63;
  --muted:#6b7280;
  --bg:#f7faf9;
  --card:#ffffff;
  --radius:12px;
  --shadow:0 8px 24px rgba(16,24,40,0.06);
  --max-width:1200px;
  --action-w:110px;
  --action-h:44px;
  font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:#0b1220;transition:0.3s;}
.dark{background:#1a1a1a;color:#eee;}
.wrap{max-width:var(--max-width);margin:0 auto;padding:0}

/* Sticky header */
header{position:sticky;top:0;z-index:100;background:var(--card);display:flex;align-items:center;justify-content:space-between;padding:12px 20px;box-shadow:0 2px 10px rgba(0,0,0,0.08);border-bottom:1px solid rgba(0,0,0,0.05);}
header h1{margin:0;font-size:20px;}
header .actions{display:flex;gap:8px;align-items:center;}

/* Buttons */
button{background:#f3f7fe;color:var(--primary);border:none;cursor:pointer;border-radius:8px;width:var(--action-w);height:var(--action-h);transition:0.2s;font-weight:600;}
button:hover{background:var(--primary);box-shadow:0 0 0 6px rgba(60,179,113,0.22);color:#fff;}
button.ghost{background:transparent;border:1px solid rgba(15,23,42,0.06);color:var(--muted);width:auto;padding:8px 12px;font-weight:500;}

/* Layout */
.app{display:grid;grid-template-columns:360px 1fr;gap:16px;padding:20px;}
.sidebar{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;display:flex;flex-direction:column;gap:12px;}
.main-card{display:flex;flex-direction:column;gap:16px;}
.results{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;display:flex;flex-direction:column;gap:16px;position:sticky;top:80px;}
h2{margin:0;font-size:18px;}
.field{margin-bottom:10px;}
label{display:block;font-size:13px;margin-bottom:4px;}
input[type=number], input[type=text]{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef0;background:#fff;transition:0.2s;}
input[type=number]:focus,input[type=text]:focus{border-color:var(--primary);outline:none;}

/* Collapsible sections */
.collapse{border:1px solid rgba(15,23,42,0.08);border-radius:10px;overflow:hidden;transition:max-height 0.3s ease;max-height:0;padding:0 12px;}
.collapse.active{max-height:600px;padding:12px;}
.collapse-header{display:flex;justify-content:space-between;align-items:center;cursor:pointer;padding:8px 0;font-weight:600;}
.tooltip{position:relative;display:inline-block;}
.tooltip .tooltiptext{visibility:hidden;width:200px;background:rgba(0,0,0,0.7);color:#fff;text-align:left;padding:6px 8px;border-radius:6px;position:absolute;z-index:10;bottom:125%;left:50%;transform:translateX(-50%);opacity:0;transition:opacity 0.3s;font-size:12px;}
.tooltip:hover .tooltiptext{visibility:visible;opacity:1;}

/* Metrics */
.metric{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;background:rgba(15,23,42,0.02);}
.metric .label{font-size:13px;color:var(--muted);}
.metric .value{font-weight:700;font-size:18px;}
.bar-wrap{margin-top:8px;}
.bar{height:14px;border-radius:8px;background:#eee;overflow:hidden;}
.bar-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--primary-dark));width:0%;transition:width .35s ease;}
.muted{color:var(--muted);font-size:13px;}

/* Scenario panel */
.scenarios{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;display:flex;flex-direction:column;gap:12px;}
.scenario-slot{display:flex;flex-direction:column;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.08);}
.scenario-header{display:flex;justify-content:space-between;align-items:center;}
.scenario-buttons button{margin-left:4px;width:60px;height:30px;font-size:12px;}
.scenario-metrics{font-size:13px;color:var(--muted);margin:4px 0;}

/* Scenario bar with tooltip */
.scenario-bar{position:relative;height:12px;background:#eee;border-radius:6px;overflow:hidden;margin-top:4px;}
.scenario-bar-fill{height:100%;border-radius:6px;width:0%;transition:width .35s ease;position:relative;cursor:pointer;}
.scenario-bar-fill:hover::after{
  content: attr(data-tooltip);
  position:absolute;
  bottom:125%;
  left:50%;
  transform:translateX(-50%);
  background:rgba(0,0,0,0.75);
  color:#fff;
  padding:6px 8px;
  border-radius:6px;
  font-size:12px;
  white-space:nowrap;
  z-index:10;
  opacity:1;
}

/* Footer */
footer{padding:14px;border-radius:10px;background:linear-gradient(90deg,rgba(60,179,113,0.03),transparent);display:flex;justify-content:space-between;align-items:center;margin:0 20px 20px 20px;font-size:13px;}
footer a{color:var(--primary);text-decoration:none;}

/* Dark mode */
.dark header{background:#222;}
.dark .sidebar,.dark .main-card,.dark .results,.dark .scenarios{background:#2a2a2a;}
.dark input{background:#3a3a3a;border:1px solid #555;color:#eee;}
.dark .bar,.dark .scenario-bar{background:#444;}
.dark .bar-fill,.dark .scenario-bar-fill{background:linear-gradient(90deg,#3cb371,#2f9d63);}
.dark footer{background:rgba(40,40,40,0.9);color:#aaa;}
@media (max-width:980px){.app{grid-template-columns:1fr;}.results{position:relative;top:auto;}}
</style>
</head>
<body>
<div class="wrap">
<header>
  <h1>ROI Calculator</h1>
  <div class="actions">
    <button id="saveBtn">Save</button>
    <button id="exportBtn">Export PDF</button>
    <button id="resetBtn" class="ghost">Reset</button>
    <button id="darkToggle" class="ghost">Dark Mode</button>
  </div>
</header>

<div class="app">
  <aside class="sidebar">
    <div class="collapse-header" onclick="toggleCollapse('processCollapse')">Process Optimization</div>
    <div class="collapse active" id="processCollapse">
      <div class="field tooltip"><label>Employees affected <span class='tooltiptext'>Number of people whose work time is impacted</span></label><input type="number" id="p_employees" min="0" step="1" value="5"></div>
      <div class="field tooltip"><label>Avg hourly wage <span class='tooltiptext'>CAD/hour per employee</span></label><input type="number" id="p_wage" min="0" step="0.01" value="28"></div>
      <div class="field tooltip"><label>Hours saved per week <span class='tooltiptext'>Time saved per employee per week</span></label><input type="number" id="p_hours_week" min="0" step="0.1" value="3"></div>
      <div class="field tooltip"><label>Implementation cost <span class='tooltiptext'>One-time cost of optimization</span></label><input type="number" id="p_cost" min="0" step="1" value="2500"></div>
    </div>

    <div class="collapse-header" onclick="toggleCollapse('softwareCollapse')">Software Investment</div>
    <div class="collapse" id="softwareCollapse">
      <div class="field tooltip"><label>Monthly software cost <span class='tooltiptext'>Recurring subscription cost</span></label><input type="number" id="s_monthly" min="0" step="0.01" value="199"></div>
      <div class="field tooltip"><label>One-time setup cost <span class='tooltiptext'>Implementation/setup fee</span></label><input type="number" id="s_setup" min="0" step="1" value="1500"></div>
      <div class="field tooltip"><label>Estimated hours saved <span class='tooltiptext'>Hours saved monthly using software</span></label><input type="number" id="s_hours_month" min="0" step="0.1" value="40"></div>
      <div class="field tooltip"><label>Avg hourly value <span class='tooltiptext'>Value of employee time per hour</span></label><input type="number" id="s_hourly_value" min="0" step="0.01" value="35"></div>
    </div>

    <div class="collapse-header" onclick="toggleCollapse('customCollapse')">Custom Input</div>
    <div class="collapse" id="customCollapse">
      <div class="field tooltip"><label>Scenario name <span class='tooltiptext'>Give your scenario a name</span></label><input type="text" id="c_name" value="New scenario"></div>
      <div class="field tooltip"><label>One-time cost <span class='tooltiptext'>Total upfront cost</span></label><input type="number" id="c_onetime" min="0" step="0.01" value="1000"></div>
      <div class="field tooltip"><label>Recurring monthly cost <span class='tooltiptext'>Ongoing monthly expenses</span></label><input type="number" id="c_monthly" min="0" step="0.01" value="0"></div>
      <div class="field tooltip"><label>Estimated monthly savings <span class='tooltiptext'>Revenue or cost savings per month</span></label><input type="number" id="c_saved_month" min="0" step="0.01" value="300"></div>
      <div class="field tooltip"><label>Time horizon (months) <span class='tooltiptext'>Duration to calculate ROI</span></label><input type="number" id="c_months" min="1" step="1" value="12"></div>
    </div>
  </aside>

  <main class="main-card">
    <div class="results">
      <h2>Results</h2>
      <div class="metric"><div class="label">Annual Savings</div><div class="value" id="val_annual">$0</div></div>
      <div class="metric"><div class="label">ROI</div><div class="value" id="val_roi">0%</div></div>
      <div class="metric"><div class="label">Payback Period</div><div class="value" id="val_payback">0 months</div></div>
      <div class="bar-wrap">
        <div class="muted">Savings vs Cost (visual)</div>
        <div class="bar"><div class="bar-fill" id="barFill"></div></div>
      </div>
      <div class="muted">Hover over fields for explanations. Use Save/Export to keep or share your scenario.</div>
    </div>

    <div class="scenarios">
      <h2>Scenario Comparison</h2>
      <div id="scenarioList"></div>
      <button id="addScenarioBtn">Add Current Scenario</button>
    </div>
  </main>
</div>

<footer>
  <div><strong>DGS Consulting</strong> — Darren Snook<br>darrengsnook@gmail.com • 905-718-3667</div>
  <div class="muted">Book a consultation: <a href="https://dgsconsulting.solutions/book" target="_blank">Link</a></div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
<script>
// Utility
const $=id=>document.getElementById(id);
function toggleCollapse(id){const c=$(id);c.classList.toggle('active');}
function fmt(n){return '$'+Number(n||0).toLocaleString(undefined,{maximumFractionDigits:2});}

// Dark mode
const darkBtn=$('darkToggle');
darkBtn.addEventListener('click',()=>{
  document.body.classList.toggle('dark');
  localStorage.setItem('dark',document.body.classList.contains('dark'));
});
if(localStorage.getItem('dark')==='true') document.body.classList.add('dark');

// Save/load inputs
function getCurrentInputs(){
  return {
    p_employees:+$('p_employees').value||0,p_wage:+$('p_wage').value||0,p_hours_week:+$('p_hours_week').value||0,p_cost:+$('p_cost').value||0,
    s_monthly:+$('s_monthly').value||0,s_setup:+$('s_setup').value||0,s_hours_month:+$('s_hours_month').value||0,s_hourly_value:+$('s_hourly_value').value||0,
    c_name:$('c_name').value,c_onetime:+$('c_onetime').value||0,c_monthly:+$('c_monthly').value||0,c_saved_month:+$('c_saved_month').value||0,c_months:+$('c_months').value||1
  };
}
function saveInputs(){localStorage.setItem('dgs_roi_inputs',JSON.stringify(getCurrentInputs()));alert('Inputs saved locally.');}
function loadInputs(){const v=localStorage.getItem('dgs_roi_inputs');if(!v) return;try{const d=JSON.parse(v);for(const k in d) if($(k)) $(k).value=d[k];}catch(e){console.warn(e);}}

// ROI Calculations
function calcMetrics(inp){
  const weeklySavings=inp.p_employees*inp.p_hours_week*inp.p_wage;
  const annualSavings=weeklySavings*52;
  const annualCost=inp.p_cost;
  const roiPercent=annualCost?((annualSavings-annualCost)/annualCost)*100:Infinity;
  const paybackMonths=weeklySavings?Math.round(annualCost/(weeklySavings*4)):Infinity;
  const fill=annualCost?Math.min(100,Math.max(0,(annualSavings/annualCost)*100)):0;
  return {annualSavings,roiPercent,paybackMonths,fill};
}

function updateResults(inp){
  const m=calcMetrics(inp);
  $('val_annual').textContent=fmt(m.annualSavings);
  $('val_roi').textContent=isFinite(m.roiPercent)?Math.round(m.roiPercent)+'%':'—';
  $('val_payback').textContent=isFinite(m.paybackMonths)?m.paybackMonths+' months':'—';
  $('barFill').style.width=isFinite(m.fill)?m.fill+'%':'0%';
}

// Scenario Comparison
let scenarios=[];
function renderScenarios(){
  const list=$('scenarioList');list.innerHTML='';
  if(!scenarios.length) return;
  const bestROI=Math.max(...scenarios.map(s=>s.roiPercent||0));
  scenarios.forEach((s,i)=>{
    const div=document.createElement('div');div.className='scenario-slot';
    const fillPerc=Math.min(100,Math.max(0,s.annualSavings/(s.c_onetime+s.c_monthly*s.c_months)*100));
    const tooltipText=`Annual: ${fmt(s.annualSavings)} | ROI: ${isFinite(s.roiPercent)?Math.round(s.roiPercent)+'%':'—'} | Payback: ${isFinite(s.paybackMonths)?s.paybackMonths+'m':'—'}`;
    div.innerHTML=`<div class="scenario-header"><span>${s.c_name}</span>
      <div class="scenario-buttons">
        <button onclick="loadScenario(${i})">Load</button>
        <button onclick="duplicateScenario(${i})">Dup</button>
        <button onclick="deleteScenario(${i})">Del</button>
      </div></div>
      <div class="scenario-metrics">${tooltipText}</div>
      <div class="scenario-bar">
        <div class="scenario-bar-fill" style="width:${fillPerc}%;background:${s.roiPercent===bestROI?'var(--primary-dark)':'var(--primary)'}" data-tooltip="${tooltipText}"></div>
      </div>`;
    list.appendChild(div);
  });
}
function addScenario(){
  if(scenarios.length>=3){alert('Max 3 scenarios');return;}
  const inp=getCurrentInputs();
  const metrics=calcMetrics(inp);
  scenarios.push({...inp,...metrics});
  renderScenarios();
}
function loadScenario(i){const s=scenarios[i];for(const k in s) if($(k)) $(k).value=s[k];updateResults(s);}
function duplicateScenario(i){if(scenarios.length>=3){alert('Max 3 scenarios');return;}scenarios.push({...scenarios[i]});renderScenarios();}
function deleteScenario(i){scenarios.splice(i,1);renderScenarios();}

// Reset / Export
$('resetBtn').addEventListener('click',()=>{if(confirm('Reset all fields?')){document.querySelectorAll('input').forEach(inp=>inp.value='');updateResults(getCurrentInputs());scenarios=[];renderScenarios();}});
$('saveBtn').addEventListener('click',saveInputs);
$('exportBtn').addEventListener('click',()=>{html2pdf().from(document.body).save('ROI-Calculator.pdf');});

// Live update
document.querySelectorAll('input').forEach(inp=>inp.addEventListener('input',()=>updateResults(getCurrentInputs())));

// Add scenario
$('addScenarioBtn').addEventListener('click',addScenario);

// Initialize
loadInputs();
updateResults(getCurrentInputs());
renderScenarios();
</script>
</body>
</html>

