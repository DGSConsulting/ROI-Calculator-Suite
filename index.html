<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ROI Calculator Suite</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
* {margin:0;padding:0;box-sizing:border-box;}
body {font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif; background:linear-gradient(to bottom right,#f0fdf4,#dcfce7); min-height:100vh; padding:24px;}
.container {max-width:80rem;margin:0 auto;}
.card {background:white;border-radius:1rem;box-shadow:0 10px 15px -3px rgba(0,0,0,0.1);padding:32px;margin-bottom:32px;}
.header {display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;}
h1 {font-size:2rem;color:#166534;}
button {background-color:#16a34a;color:white;border:none;cursor:pointer;border-radius:8px;width:120px;height:45px;font-weight:600;font-size:14px;transition:0.3s;}
button:hover {background-color:#15803d;box-shadow:0 0 0 5px #16a34a60;}
.calculator-tabs {display:flex;flex-wrap:wrap;gap:8px;margin-bottom:32px;}
.tab-button {padding:12px 16px;border-radius:0.5rem;font-weight:600;cursor:pointer;border:none;background-color:#d1fae5;color:#166534;transition:0.3s;}
.tab-button.active {background-color:#16a34a;color:white;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);}
.tab-button:hover {background-color:#bbf7d0;}
.tab-button.active:hover {background-color:#15803d;}
.input-group {margin-bottom:16px;}
label {display:block;font-size:0.875rem;font-weight:500;color:#166534;margin-bottom:4px;}
input {width:100%;padding:10px 16px;border:1px solid #d1d5db;border-radius:0.5rem;font-size:14px;}
input:focus {outline:none;border-color:#16a34a;box-shadow:0 0 0 3px rgba(22,99,52,0.1);}
.grid-2 {display:grid;grid-template-columns:repeat(2,1fr);gap:16px;}
.grid-3 {display:grid;grid-template-columns:repeat(3,1fr);gap:16px;}
.advanced-section {background-color:#f0fdf4;padding:16px;border-radius:0.5rem;margin:16px 0;display:none;}
.toggle-advanced {color:#16a34a;cursor:pointer;font-size:0.875rem;margin:16px 0;text-decoration:underline;}
.result-box {background-color:#bbf7d0;padding:16px;border-radius:0.5rem;margin-top:16px;}
.result-label {font-size:0.875rem;color:#166534;margin-bottom:4px;}
.result-value {font-size:1.875rem;font-weight:bold;color:#16a34a;}
.scenario-input {display:flex;gap:8px;margin-top:24px;}
.scenario-input input {flex:1;}
.scenarios-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-top:16px;}
.scenario-card {border:1px solid #d1fae5;border-radius:0.5rem;padding:16px;transition:0.3s;}
.scenario-card:hover {box-shadow:0 10px 15px -3px rgba(0,0,0,0.1);}
.scenario-card h3 {font-weight:600;color:#166534;margin-bottom:8px;}
.scenario-card p {font-size:0.875rem;color:#166534;margin-bottom:12px;}
.scenario-buttons {display:flex;gap:8px;}
footer {margin-top:48px;padding:32px;border-top:1px solid #d1fae5;text-align:center;}
footer p {color:#166534;font-size:0.875rem;margin-bottom:12px;}
.footer-links {display:flex;justify-content:center;gap:16px;flex-wrap:wrap;}
.footer-links a {padding:10px 16px;background-color:#16a34a;color:white;border-radius:0.5rem;font-size:0.875rem;font-weight:500;text-decoration:none;transition:0.3s;}
.footer-links a:hover {background-color:#15803d;}
@media(max-width:768px){.grid-2,.grid-3{grid-template-columns:1fr;}.calculator-tabs{grid-template-columns:1fr;}h1{font-size:1.5rem;}}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <div class="header">
      <h1>ROI Calculator</h1>
      <div class="header-buttons">
        <button onclick="toggleComparisonMode()">Compare Mode</button>
        <button onclick="exportToCSV()">Export</button>
      </div>
    </div>

    <div class="calculator-tabs" id="tabs">
      <button class="tab-button active" onclick="setCalculatorType('basic')">Process ROI</button>
      <button class="tab-button" onclick="setCalculatorType('marketing')">Marketing ROI</button>
      <button class="tab-button" onclick="setCalculatorType('investment')">Software Investment</button>
    </div>

    <div id="calculator-content"></div>

    <div class="scenario-input">
      <input type="text" id="scenarioName" placeholder="Scenario name...">
      <button onclick="saveScenario()">Save Scenario</button>
    </div>

    <canvas id="roiChart" height="200" style="margin-top:32px;"></canvas>
  </div>

  <div id="scenarios-section"></div>

  <footer>
    <p>DGS Consulting</p>
    <div class="footer-links">
      <a href="https://dgsconsulting.solutions/" target="_blank">Website</a>
      <a href="https://www.linkedin.com/in/dg-snook/" target="_blank">LinkedIn</a>
      <a href="mailto:DGSConsult@consultant.com">Contact</a>
    </div>
  </footer>
</div>

<script>
let currentCalcType = 'basic';
let scenarios = [];
let comparisonMode = false;

// Predefined example templates
const exampleScenarios = [
  {name:'Template A', type:'basic', data:{investment:5000, gain:7500, taxRate:10, inflation:2}},
  {name:'Template B', type:'marketing', data:{spent:2000, revenue:4000, taxRate:15}},
  {name:'Template C', type:'investment', data:{initialInvestment:10000, finalValue:15000, years:2, taxRate:20, inflation:3}}
];

let roiTrendData = {basic:[], marketing:[], investment:[]};
const formData = {basic:{investment:0,gain:0,taxRate:0,inflation:0}, marketing:{spent:0,revenue:0,taxRate:0}, investment:{initialInvestment:0,finalValue:0,years:1,taxRate:0,inflation:0}};

function setCalculatorType(type){
  currentCalcType = type;
  document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  renderCalculator();
}

function renderCalculator(){
  const content = document.getElementById('calculator-content');
  const data = formData[currentCalcType];
  let html = '';
  if(currentCalcType==='basic'){
    html = `<div class="grid-2">
      <div class="input-group"><label>Total Investment ($)</label><input type="number" id="investment" value="${data.investment}" onchange="updateFormData()"></div>
      <div class="input-group"><label>Total Gain ($)</label><input type="number" id="gain" value="${data.gain}" onchange="updateFormData()"></div>
    </div>
    <div class="toggle-advanced" onclick="toggleAdvanced('basic')">Show Advanced Options</div>
    <div class="advanced-section" id="advanced-basic">
      <div class="grid-2">
        <div class="input-group"><label>Tax Rate (%)</label><input type="number" id="taxRate" value="${data.taxRate}" onchange="updateFormData()"></div>
        <div class="input-group"><label>Inflation (%)</label><input type="number" id="inflation" value="${data.inflation}" onchange="updateFormData()"></div>
      </div>
    </div>
    <button onclick="calculateROI()">Calculate ROI</button>
    <div class="result-box"><div class="result-label">ROI</div><div class="result-value" id="roiResult">0%</div></div>`;
  } else if(currentCalcType==='marketing'){
    html = `<div class="grid-2">
      <div class="input-group"><label>Marketing Spend ($)</label><input type="number" id="spent" value="${data.spent}" onchange="updateFormData()"></div>
      <div class="input-group"><label>Revenue ($)</label><input type="number" id="revenue" value="${data.revenue}" onchange="updateFormData()"></div>
    </div>
    <div class="toggle-advanced" onclick="toggleAdvanced('marketing')">Show Advanced Options</div>
    <div class="advanced-section" id="advanced-marketing">
      <div class="grid-2">
        <div class="input-group"><label>Tax Rate (%)</label><input type="number" id="taxRate" value="${data.taxRate}" onchange="updateFormData()"></div>
      </div>
    </div>
    <button onclick="calculateROI()">Calculate ROI</button>
    <div class="result-box"><div class="result-label">ROI</div><div class="result-value" id="roiResult">0%</div></div>`;
  } else if(currentCalcType==='investment'){
    html = `<div class="grid-2">
      <div class="input-group"><label>Initial Investment ($)</label><input type="number" id="initialInvestment" value="${data.initialInvestment}" onchange="updateFormData()"></div>
      <div class="input-group"><label>Final Value ($)</label><input type="number" id="finalValue" value="${data.finalValue}" onchange="updateFormData()"></div>
      <div class="input-group"><label>Years</label><input type="number" id="years" value="${data.years}" onchange="updateFormData()"></div>
    </div>
    <div class="toggle-advanced" onclick="toggleAdvanced('investment')">Show Advanced Options</div>
    <div class="advanced-section" id="advanced-investment">
      <div class="grid-2">
        <div class="input-group"><label>Tax Rate (%)</label><input type="number" id="taxRate" value="${data.taxRate}" onchange="updateFormData()"></div>
        <div class="input-group"><label>Inflation (%)</label><input type="number" id="inflation" value="${data.inflation}" onchange="updateFormData()"></div>
      </div>
    </div>
    <button onclick="calculateROI()">Calculate ROI</button>
    <div class="result-box"><div class="result-label">ROI</div><div class="result-value" id="roiResult">0%</div></div>`;
  }
  content.innerHTML = html;
}

function toggleAdvanced(type){
  const section = document.getElementById(`advanced-${type}`);
  section.style.display = section.style.display==='none'?'block':'none';
}

function updateFormData(){
  const data = formData[currentCalcType];
  for(let key in data){
    const input = document.getElementById(key);
    if(input) data[key] = parseFloat(input.value)||0;
  }
}

function calculateROI(){
  updateFormData();
  let roi=0;
  if(currentCalcType==='basic'){
    roi=((formData.basic.gain-formData.basic.investment)/formData.basic.investment)*100;
    roi-=roi*formData.basic.taxRate/100;
  } else if(currentCalcType==='marketing'){
    roi=((formData.marketing.revenue-formData.marketing.spent)/formData.marketing.spent)*100;
    roi-=roi*formData.marketing.taxRate/100;
  } else if(currentCalcType==='investment'){
    roi=(Math.pow(formData.investment.finalValue/formData.investment.initialInvestment,1/formData.investment.years)-1)*100;
    roi-=roi*formData.investment.taxRate/100;
  }
  document.getElementById('roiResult').innerText=roi.toFixed(2)+'%';
  roiTrendData[currentCalcType].push({label:`${currentCalcType} #${roiTrendData[currentCalcType].length+1}`, roi});
  updateROIChart();
}

function saveScenario(){
  const name=document.getElementById('scenarioName').value.trim();
  if(!name) return alert('Enter scenario name');
  const scenario={name,type:currentCalcType,data:{...formData[currentCalcType]}};
  scenarios.push(scenario);
  document.getElementById('scenarioName').value='';
  renderScenarios();
}

function renderScenarios(){
  const section=document.getElementById('scenarios-section');
  if(!scenarios.length){ section.innerHTML=''; return;}
  let html='<div class="scenarios-grid">';
  scenarios.forEach((s,i)=>{
    html+=`<div class="scenario-card">
      <h3>${s.name}</h3>
      <p>Type: ${s.type}</p>
      <p>ROI: ${document.getElementById('roiResult')?document.getElementById('roiResult').innerText:'0%'}</p>
      <div class="scenario-buttons">
        <button onclick="loadScenario(${i})">Load</button>
        <button onclick="deleteScenario(${i})">Delete</button>
      </div>
    </div>`;
  });
  html+='</div>';
  section.innerHTML=html;
}

function loadScenario(i){
  const s=scenarios[i];
  currentCalcType=s.type;
  formData[s.type]={...s.data};
  document.querySelectorAll('.tab-button').forEach(btn=>btn.classList.remove('active'));
  document.querySelector(`#tabs button:nth-child(${['basic','marketing','investment'].indexOf(s.type)+1})`).classList.add('active');
  renderCalculator();
  calculateROI();
}

function deleteScenario(i){scenarios.splice(i,1); renderScenarios();}

let roiChart = new Chart(document.getElementById('roiChart'),{
  type:'line',
  data:{labels:[],datasets:[
    {label:'Process ROI',data:[],borderColor:'#16a34a',backgroundColor:'rgba(22,163,74,0.2)',tension:0.3},
    {label:'Marketing ROI',data:[],borderColor:'#15803d',backgroundColor:'rgba(21,128,61,0.2)',tension:0.3},
    {label:'Software Investment',data:[],borderColor:'#166534',backgroundColor:'rgba(22,101,52,0.2)',tension:0.3}
  ]},
  options:{responsive:true,scales:{y:{beginAtZero:true}}}
});

function updateROIChart(){
  roiChart.data.datasets[0].data = roiTrendData.basic.map(d=>d.roi);
  roiChart.data.datasets[1].data = roiTrendData.marketing.map(d=>d.roi);
  roiChart.data.datasets[2].data = roiTrendData.investment.map(d=>d.roi);
  const maxLength = Math.max(roiTrendData.basic.length, roiTrendData.marketing.length, roiTrendData.investment.length);
  roiChart.data.labels = Array.from({length:maxLength},(_,i)=>`Scenario ${i+1}`);
  roiChart.update();
}

// Initialize example templates
exampleScenarios.forEach(e=>{scenarios.push(e); calculateROI();});
renderScenarios();
renderCalculator();

function toggleComparisonMode(){comparisonMode=!comparisonMode;alert('Comparison mode '+(comparisonMode?'ON':'OFF'));}
function exportToCSV(){if(!scenarios.length) return alert('No scenarios to export'); let csv='Name,Type,ROI\n'; scenarios.forEach(s=>{csv+=`${s.name},${s.type},${parseFloat(document.getElementById('roiResult').innerText).toFixed(2)}\n`}); const blob=new Blob([csv],{type:'text/csv'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='roi_scenarios.csv'; a.click();}
</script>
</body>
</html>
