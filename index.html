<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DGS Consulting — ROI Calculators (SMB)</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
  /* Reset & baseline */
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html,body { height:100%; }
  body {
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg,#f6fff7,#e6f7ee);
    color: #064e3b;
    padding: 24px;
    -webkit-font-smoothing:antialiased;
  }

  .container { max-width: 1100px; margin: 0 auto; }

  header { text-align:center; margin-bottom: 18px; }
  header h1 { font-size: 28px; color: #065f46; margin-bottom:8px; }
  header p { color: #065f46; opacity: .8; }

  .card {
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(6,95,70,0.06);
    padding: 20px;
    margin-bottom: 20px;
  }

  /* Header buttons centered and single-line */
  .header-actions { display:flex; justify-content:center; gap:12px; margin-top:12px; flex-wrap:wrap; }
  button {
    background: #16a34a;
    color: #fff;
    border: none;
    border-radius: 8px;
    min-width: 140px;
    height: 44px;
    padding: 0 16px;
    font-weight: 600;
    cursor: pointer;
    white-space: nowrap;
  }
  button.secondary { background: #065f46; }
  button.danger { background: #dc2626; }
  button.small { min-width: 110px; height: 38px; font-size: 14px; }

  /* Grid for calculators */
  .calc-grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(320px,1fr)); gap:16px; }

  .calc-card { padding:18px; border-radius:10px; background:#f0fff6; }

  .calc-card h3 { color:#065f46; margin-bottom:12px; font-size:18px; text-align:center; }

  .input-row { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:10px; }
  .input-row.single { grid-template-columns:1fr; }
  label { display:block; font-size:13px; color:#064e3b; margin-bottom:6px; font-weight:600; }
  input[type="number"], input[type="text"], select {
    width:100%;
    padding:10px 12px;
    border-radius:8px;
    border:1px solid #dbeadc;
    font-size:14px;
  }
  .calc-actions { display:flex; gap:10px; margin-top:12px; justify-content:center; flex-wrap:wrap; }
  .result { margin-top:12px; text-align:center; font-weight:700; font-size:18px; color:#064e3b; }

  /* Scenarios / comparison */
  .scenarios { display:grid; grid-template-columns:1fr 360px; gap:16px; align-items:start; }
  .scenarios-list { max-height:360px; overflow:auto; padding-right:8px; }
  .scenario-item {
    background:#ffffff; border-radius:8px; padding:10px; margin-bottom:10px;
    border:1px solid #e6f7ee; display:flex; justify-content:space-between; gap:8px; align-items:center;
  }
  .scenario-meta { font-size:13px; color:#064e3b; }
  .scenario-controls { display:flex; gap:6px; }

  /* Guide (improved UX) */
  .guide-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:12px; margin-top:12px; }
  .guide-card {
    background: linear-gradient(180deg,#f7fff9,#f0fff6);
    padding:12px; border-radius:10px; border-left:4px solid #16a34a;
  }
  .guide-card h4 { font-size:15px; margin-bottom:6px; color:#065f46; }
  .guide-card p { font-size:13px; color:#064e3b; opacity:.9; }

  footer { margin-top:20px; text-align:center; color:#065f46; font-size:13px; }

  /* responsive tweaks */
  @media (max-width:820px) {
    .scenarios { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
  <div class="container">

    <header>
      <h1>ROI Calculator — DGS Consulting</h1>
      <p>Practical ROI tools for small businesses: process changes, software, and training. Simple inputs. Instant results. Save scenarios and compare.</p>
      <div class="header-actions" style="margin-top:14px;">
        <button class="secondary" onclick="loadTemplates()">Load Example Templates</button>
        <button onclick="exportCSV()">Export Scenarios</button>
        <button class="danger" onclick="clearAll()">Clear All</button>
      </div>
    </header>

    <!-- Calculators grid -->
    <div class="card calc-grid">

      <!-- Process Optimization ROI -->
      <div class="calc-card" id="processCard">
        <h3>Process Optimization ROI</h3>
        <div class="input-row">
          <div>
            <label>Hours saved per week (total team)</label>
            <input id="proc_hours_week" type="number" min="0" step="0.1" placeholder="e.g. 5">
          </div>
          <div>
            <label>Average fully-burdened hourly rate ($)</label>
            <input id="proc_hourly_rate" type="number" min="0" step="0.01" placeholder="e.g. 30">
          </div>
        </div>

        <div class="input-row">
          <div>
            <label>One-time implementation cost ($)</label>
            <input id="proc_cost" type="number" min="0" step="0.01" placeholder="e.g. 2000">
          </div>
          <div>
            <label>Timeframe to annualize (weeks)</label>
            <input id="proc_weeks" type="number" min="1" step="1" value="52">
          </div>
        </div>

        <div class="calc-actions">
          <button onclick="calcProcessROI()">Calculate</button>
          <button class="small" onclick="saveScenarioFromForm('process')">Save Scenario</button>
        </div>

        <div class="result" id="proc_result">—</div>
        <canvas id="proc_chart" style="margin-top:12px;"></canvas>
      </div>

      <!-- Tech Stack / Software ROI -->
      <div class="calc-card" id="softwareCard">
        <h3>Tech Stack / Software ROI</h3>

        <div class="input-row">
          <div>
            <label>Current annual cost of tool(s) ($)</label>
            <input id="soft_current_cost" type="number" min="0" step="0.01" placeholder="e.g. 12000">
          </div>
          <div>
            <label>Expected efficiency gain (%)</label>
            <input id="soft_eff_gain" type="number" min="0" step="0.1" placeholder="e.g. 15">
          </div>
        </div>

        <div class="input-row">
          <div>
            <label>New/replacement cost (one-time or annual) ($)</label>
            <input id="soft_new_cost" type="number" min="0" step="0.01" placeholder="e.g. 5000">
          </div>
          <div>
            <label>Annualize new cost over (years)</label>
            <input id="soft_years" type="number" min="1" step="1" value="1">
          </div>
        </div>

        <div class="calc-actions">
          <button onclick="calcSoftwareROI()">Calculate</button>
          <button class="small" onclick="saveScenarioFromForm('software')">Save Scenario</button>
        </div>

        <div class="result" id="soft_result">—</div>
        <canvas id="soft_chart" style="margin-top:12px;"></canvas>
      </div>

      <!-- Training Investment ROI -->
      <div class="calc-card" id="trainingCard">
        <h3>Training Investment ROI</h3>

        <div class="input-row">
          <div>
            <label>Number of employees trained</label>
            <input id="train_count" type="number" min="0" step="1" placeholder="e.g. 3">
          </div>
          <div>
            <label>Estimated revenue per employee annually ($)</label>
            <input id="train_rev_per_emp" type="number" min="0" step="1" placeholder="e.g. 60000">
          </div>
        </div>

        <div class="input-row">
          <div>
            <label>Expected productivity gain (%)</label>
            <input id="train_prod_gain" type="number" min="0" step="0.1" placeholder="e.g. 5">
          </div>
          <div>
            <label>Training cost (total) ($)</label>
            <input id="train_cost" type="number" min="0" step="0.01" placeholder="e.g. 3000">
          </div>
        </div>

        <div class="calc-actions">
          <button onclick="calcTrainingROI()">Calculate</button>
          <button class="small" onclick="saveScenarioFromForm('training')">Save Scenario</button>
        </div>

        <div class="result" id="train_result">—</div>
        <canvas id="train_chart" style="margin-top:12px;"></canvas>
      </div>

    </div> <!-- end calc-grid -->

    <!-- Scenarios & Comparison -->
    <div class="card" style="margin-top:16px;">
      <h3 style="text-align:center; margin-bottom:12px;">Saved Scenarios & Comparison</h3>
      <div class="scenarios">

        <!-- Left: list -->
        <div class="scenarios-list card" style="padding:12px;">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
            <strong>Scenarios</strong>
            <div>
              <button class="small" onclick="renderTemplatesList()" style="margin-right:6px">Templates</button>
              <button class="small" onclick="clearScenarios()">Clear</button>
            </div>
          </div>

          <div id="scenariosContainer"></div>
        </div>

        <!-- Right: comparison chart -->
        <div class="card" style="padding:12px;">
          <strong style="display:block;margin-bottom:8px;">Comparison Chart</strong>
          <canvas id="comparisonChart" width="360" height="260"></canvas>
          <div style="font-size:13px;margin-top:8px;color:#065f46;">Saved scenario ROI values (percentage). Click a scenario's Load or Delete button in the list.</div>
        </div>
      </div>
    </div>

    <!-- Improved Calculator Guide -->
    <div class="card" style="margin-top:16px;">
      <h3 style="text-align:center;">Calculator Guide</h3>
      <div class="guide-grid" style="margin-top:12px;">
        <div class="guide-card">
          <h4>Process Optimization ROI</h4>
          <p>Estimate annual savings from time reclaimed by staff. Useful for workflow changes, automation, or process cleanup projects.</p>
        </div>
        <div class="guide-card">
          <h4>Tech Stack / Software ROI</h4>
          <p>Compare current tool cost vs new option and expected efficiency improvements. Great for procurement decisions.</p>
        </div>
        <div class="guide-card">
          <h4>Training Investment ROI</h4>
          <p>Model productivity improvements after staff training and compare them against the training budget.</p>
        </div>
      </div>
    </div>

    <footer>
      DGS Consulting — ROI Calculator for small business owners. Built for clear decisions.
    </footer>
  </div>

<script>
/* ------------------------------
  State: scenarios, trend arrays
   - scenarios: saved items with id,name,type,data,result
   - trends per calculator: arrays for charting historical runs
--------------------------------*/
let scenarios = [];
const trends = { process: [], software: [], training: [] };

/* Chart instances */
const procCtx = document.getElementById('proc_chart').getContext('2d');
const procChart = new Chart(procCtx, {
  type: 'line',
  data: { labels: [], datasets: [{ label: 'Process ROI %', data: [], borderColor:'#16a34a', backgroundColor:'rgba(22,163,74,0.12)', tension:0.3 }] },
  options: { responsive:true, plugins:{legend:{display:false}}, scales:{ y:{ beginAtZero:true } } }
});

const softCtx = document.getElementById('soft_chart').getContext('2d');
const softChart = new Chart(softCtx, {
  type:'line',
  data:{ labels: [], datasets:[{ label:'Software ROI %', data:[], borderColor:'#065f46', backgroundColor:'rgba(6,95,70,0.12)', tension:0.3 }]},
  options:{ responsive:true, plugins:{legend:{display:false}}, scales:{ y:{ beginAtZero:true } } }
});

const trainCtx = document.getElementById('train_chart').getContext('2d');
const trainChart = new Chart(trainCtx, {
  type:'line',
  data:{ labels: [], datasets:[{ label:'Training ROI %', data:[], borderColor:'#15803d', backgroundColor:'rgba(21,128,61,0.12)', tension:0.3 }]},
  options:{ responsive:true, plugins:{legend:{display:false}}, scales:{ y:{ beginAtZero:true } } }
});

const compCtx = document.getElementById('comparisonChart').getContext('2d');
let comparisonChart = new Chart(compCtx, {
  type:'bar',
  data: { labels: [], datasets: [{ label:'ROI %', data: [], backgroundColor: [] }] },
  options: { responsive:true, plugins:{legend:{display:false}}, scales:{ y:{ beginAtZero:true } } }
});

/* ---------- Calculation functions (SMB-friendly formulas) ---------- */

/* Process Optimization:
   AnnualSavings = hoursSavedPerWeek * hourlyRate * weeksToAnnualize
   ROI% = (AnnualSavings - cost) / cost * 100
*/
function calcProcessROI(){
  const hours = parseFloat(document.getElementById('proc_hours_week').value) || 0;
  const rate = parseFloat(document.getElementById('proc_hourly_rate').value) || 0;
  const cost = parseFloat(document.getElementById('proc_cost').value) || 0;
  const weeks = parseFloat(document.getElementById('proc_weeks').value) || 52;

  const annualSavings = hours * rate * weeks;
  const roi = cost === 0 ? (annualSavings>0 ? 9999 : 0) : ((annualSavings - cost) / cost) * 100;

  const roiRounded = Number.isFinite(roi) ? parseFloat(roi.toFixed(2)) : 0;
  document.getElementById('proc_result').textContent = `Estimated annual savings: $${numberWithCommas(annualSavings.toFixed(2))} — ROI: ${roiRounded}%`;
  pushTrend('process', roiRounded);
}

/* Software ROI:
   AnnualBenefit = currentAnnualCost * (efficiencyGain% / 100)
   AnnualizedNewCost = newCost / years
   ROI% = (AnnualBenefit - AnnualizedNewCost) / AnnualizedNewCost * 100
*/
function calcSoftwareROI(){
  const current = parseFloat(document.getElementById('soft_current_cost').value) || 0;
  const gainPct = parseFloat(document.getElementById('soft_eff_gain').value) || 0;
  const newCost = parseFloat(document.getElementById('soft_new_cost').value) || 0;
  const years = parseFloat(document.getElementById('soft_years').value) || 1;

  const annualBenefit = current * (gainPct / 100);
  const annualizedNewCost = newCost / years;
  const roi = annualizedNewCost === 0 ? (annualBenefit>0 ? 9999 : 0) : ((annualBenefit - annualizedNewCost) / annualizedNewCost) * 100;

  const roiRounded = Number.isFinite(roi) ? parseFloat(roi.toFixed(2)) : 0;
  document.getElementById('soft_result').textContent = `Estimated annual benefit: $${numberWithCommas(annualBenefit.toFixed(2))} — ROI: ${roiRounded}%`;
  pushTrend('software', roiRounded);
}

/* Training ROI:
   AnnualBenefit = players * revPerEmployee * (prodGain%/100)
   ROI% = (AnnualBenefit - trainingCost) / trainingCost * 100
*/
function calcTrainingROI(){
  const count = parseFloat(document.getElementById('train_count').value) || 0;
  const revPer = parseFloat(document.getElementById('train_rev_per_emp').value) || 0;
  const prodGain = parseFloat(document.getElementById('train_prod_gain').value) || 0;
  const cost = parseFloat(document.getElementById('train_cost').value) || 0;

  const annualBenefit = count * revPer * (prodGain / 100);
  const roi = cost === 0 ? (annualBenefit>0 ? 9999 : 0) : ((annualBenefit - cost) / cost) * 100;

  const roiRounded = Number.isFinite(roi) ? parseFloat(roi.toFixed(2)) : 0;
  document.getElementById('train_result').textContent = `Estimated annual benefit: $${numberWithCommas(annualBenefit.toFixed(2))} — ROI: ${roiRounded}%`;
  pushTrend('training', roiRounded);
}

/* ---------- Trend & scenario helpers ---------- */

function numberWithCommas(x){ return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ","); }

function pushTrend(type, roiValue){
  if(!isFinite(roiValue)) return;
  const tgt = (type==='process') ? procChart : (type==='software' ? softChart : trainChart);
  const arr = (type==='process') ? trends.process : (type==='software' ? trends.software : trends.training);
  arr.push(roiValue);

  // labels as sample index
  const labels = arr.map((_,i)=>`#${i+1}`);
  tgt.data.labels = labels;
  tgt.data.datasets[0].data = arr;
  tgt.update();
}

/* ---------- Scenarios: save/load/delete, comparison chart ---------- */

function saveScenarioFromForm(type){
  // read inputs based on type and calculate result first
  if(type==='process'){ calcProcessROI(); var resultText = document.getElementById('proc_result').textContent; }
  else if(type==='software'){ calcSoftwareROI(); var resultText = document.getElementById('soft_result').textContent; }
  else { calcTrainingROI(); var resultText = document.getElementById('train_result').textContent; }

  // Collect input snapshot
  let dataSnapshot = {};
  let resultValue = 0;
  if(type==='process'){
    dataSnapshot = {
      hoursPerWeek: parseFloat(document.getElementById('proc_hours_week').value) || 0,
      hourlyRate: parseFloat(document.getElementById('proc_hourly_rate').value) || 0,
      cost: parseFloat(document.getElementById('proc_cost').value) || 0,
      weeks: parseFloat(document.getElementById('proc_weeks').value) || 52
    };
    // extract roi from resultText
    const m = resultText.match(/ROI:\s*([-\d.]+)/);
    resultValue = m ? parseFloat(m[1]) : 0;
  } else if(type==='software'){
    dataSnapshot = {
      currentCost: parseFloat(document.getElementById('soft_current_cost').value) || 0,
      effGainPct: parseFloat(document.getElementById('soft_eff_gain').value) || 0,
      newCost: parseFloat(document.getElementById('soft_new_cost').value) || 0,
      years: parseFloat(document.getElementById('soft_years').value) || 1
    };
    const m = resultText.match(/ROI:\s*([-\d.]+)/);
    resultValue = m ? parseFloat(m[1]) : 0;
  } else {
    dataSnapshot = {
      count: parseFloat(document.getElementById('train_count').value) || 0,
      revPerEmp: parseFloat(document.getElementById('train_rev_per_emp').value) || 0,
      prodGainPct: parseFloat(document.getElementById('train_prod_gain').value) || 0,
      cost: parseFloat(document.getElementById('train_cost').value) || 0
    };
    const m = resultText.match(/ROI:\s*([-\d.]+)/);
    resultValue = m ? parseFloat(m[1]) : 0;
  }

  const name = prompt("Scenario name:", type.charAt(0).toUpperCase() + type.slice(1) + " scenario");
  if(!name) return;

  const id = Date.now() + Math.floor(Math.random()*1000);
  scenarios.push({ id, name, type, data: dataSnapshot, result: resultValue });
  renderScenarios();
  updateComparisonChart();
}

/* Render scenario list */
function renderScenarios(){
  const container = document.getElementById('scenariosContainer');
  container.innerHTML = '';
  if(scenarios.length === 0) container.innerHTML = '<div style="color:#065f46;opacity:.8">No saved scenarios yet. Use calculate → Save Scenario.</div>';
  scenarios.forEach((s, i) => {
    const item = document.createElement('div');
    item.className = 'scenario-item';
    const meta = document.createElement('div');
    meta.className = 'scenario-meta';
    meta.innerHTML = `<div style="font-weight:700">${escapeHtml(s.name)}</div><div style="font-size:12px;color:#0b6b45">${escapeHtml(s.type)} — ROI: ${isFinite(s.result)?s.result+'%':'—'}</div>`;
    const controls = document.createElement('div');
    controls.className = 'scenario-controls';
    const loadBtn = document.createElement('button'); loadBtn.className='small'; loadBtn.textContent='Load'; loadBtn.onclick = ()=>loadScenario(i);
    const delBtn = document.createElement('button'); delBtn.className='danger small'; delBtn.textContent='Delete'; delBtn.onclick = ()=>{ if(confirm('Delete scenario?')) { scenarios.splice(i,1); renderScenarios(); updateComparisonChart(); }};
    controls.appendChild(loadBtn); controls.appendChild(delBtn);
    item.appendChild(meta); item.appendChild(controls);
    container.appendChild(item);
  });
}

/* Load scenario: populate form and recalc */
function loadScenario(index){
  const s = scenarios[index];
  if(!s) return alert('Scenario not found');
  if(s.type === 'process'){
    document.getElementById('proc_hours_week').value = s.data.hoursPerWeek || 0;
    document.getElementById('proc_hourly_rate').value = s.data.hourlyRate || 0;
    document.getElementById('proc_cost').value = s.data.cost || 0;
    document.getElementById('proc_weeks').value = s.data.weeks || 52;
    calcProcessROI();
  } else if(s.type === 'software'){
    document.getElementById('soft_current_cost').value = s.data.currentCost || 0;
    document.getElementById('soft_eff_gain').value = s.data.effGainPct || 0;
    document.getElementById('soft_new_cost').value = s.data.newCost || 0;
    document.getElementById('soft_years').value = s.data.years || 1;
    calcSoftwareROI();
  } else {
    document.getElementById('train_count').value = s.data.count || 0;
    document.getElementById('train_rev_per_emp').value = s.data.revPerEmp || 0;
    document.getElementById('train_prod_gain').value = s.data.prodGainPct || 0;
    document.getElementById('train_cost').value = s.data.cost || 0;
    calcTrainingROI();
  }
  alert('Scenario loaded: ' + s.name + '. Adjust values then re-calc if needed.');
}

/* Comparison chart updates from scenarios array */
function updateComparisonChart(){
  const labels = scenarios.map(s=>s.name);
  const data = scenarios.map(s=> (isFinite(s.result) ? s.result : 0) );
  const colors = scenarios.map((_,i)=>`hsl(140, ${50 + (i*7)%30}%, ${45 + (i*3)%20}%)`);
  comparisonChart.data.labels = labels;
  comparisonChart.data.datasets[0].data = data;
  comparisonChart.data.datasets[0].backgroundColor = colors;
  comparisonChart.update();
}

/* Export CSV */
function exportCSV(){
  if(scenarios.length === 0) return alert('No scenarios to export.');
  const header = ['Name','Type','Result_ROI_pct','Data_JSON'];
  const rows = scenarios.map(s=>{
    return [escapeCsv(s.name), s.type, isFinite(s.result)?s.result:'', escapeCsv(JSON.stringify(s.data))].join(',');
  });
  const csv = [header.join(','), ...rows].join('\n');
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'dgs_scenarios.csv'; a.click();
  URL.revokeObjectURL(url);
}

/* Clear helpers */
function clearScenarios(){ if(confirm('Clear all scenarios?')) { scenarios = []; renderScenarios(); updateComparisonChart(); } }
function clearAll(){ if(confirm('Clear all scenarios and graphs?')) { scenarios = []; trends.process = []; trends.software = []; trends.training = []; procChart.data.labels=[]; procChart.data.datasets[0].data=[]; softChart.data.labels=[]; softChart.data.datasets[0].data=[]; trainChart.data.labels=[]; trainChart.data.datasets[0].data=[]; procChart.update(); softChart.update(); trainChart.update(); renderScenarios(); updateComparisonChart(); } }

/* Templates (examples) */
function loadTemplates(){
  // example templates targeted at SMB use-cases
  const t1 = { id:Date.now()+1, name:'Quick wins: Process cleanup', type:'process',
               data:{hoursPerWeek:4, hourlyRate:30, cost:1500, weeks:52}, result:0};
  const t2 = { id:Date.now()+2, name:'Swap to lighter tool', type:'software',
               data:{currentCost:12000, effGainPct:20, newCost:4000, years:1}, result:0};
  const t3 = { id:Date.now()+3, name:'Short training for sales team', type:'training',
               data:{count:3, revPerEmp:60000, prodGainPct:5, cost:3000}, result:0};

  // compute their ROI immediately
  [t1,t2,t3].forEach(t=>{
    if(t.type==='process'){
      const annualSavings = t.data.hoursPerWeek * t.data.hourlyRate * t.data.weeks;
      t.result = t.data.cost === 0 ? (annualSavings>0?9999:0) : Number((((annualSavings - t.data.cost)/t.data.cost)*100).toFixed(2));
      trends.process.push(t.result); procChart.data.labels.push(`#${trends.process.length}`); procChart.data.datasets[0].data = trends.process; procChart.update();
    } else if(t.type==='software'){
      const annualBenefit = t.data.currentCost * (t.data.effGainPct/100);
      const annualizedNew = t.data.newCost / t.data.years;
      t.result = annualizedNew === 0 ? (annualBenefit>0?9999:0) : Number((((annualBenefit - annualizedNew)/annualizedNew)*100).toFixed(2));
      trends.software.push(t.result); softChart.data.labels.push(`#${trends.software.length}`); softChart.data.datasets[0].data = trends.software; softChart.update();
    } else {
      const annualBenefit = t.data.count * t.data.revPerEmp * (t.data.prodGainPct/100);
      t.result = t.data.cost === 0 ? (annualBenefit>0?9999:0) : Number((((annualBenefit - t.data.cost)/t.data.cost)*100).toFixed(2));
      trends.training.push(t.result); trainChart.data.labels.push(`#${trends.training.length}`); trainChart.data.datasets[0].data = trends.training; trainChart.update();
    }
    scenarios.push(t);
  });

  renderScenarios();
  updateComparisonChart();
  alert('Templates loaded. You can load or delete them from the list.');
}

/* Utility safe functions */
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
function escapeCsv(s){ return `"${String(s).replace(/"/g,'""')}"`; }

/* initial render */
renderScenarios();
updateComparisonChart();

/* End of script */
</script>
</body>
</html>
